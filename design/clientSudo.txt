static fields

class Action{
    int player
    int clock
    int move
}

List<Action> rawActions
List<Action> cleanActions
int numberOfActions = 0
int clock = 0

keyhandlethread

loop{
    if keypressed{
        putActionOnServerStack(playerid, clock, move)
    }
}

gamelogicthread

State state = new State()
State saveState = new State()

loop{
    state = updateState(state, cleanActions)
    renderState(state)
    clock++
    wait(timeUntilLoopLast100ms)
}

readerthread

loop{
    rawActions.add(WaitUntilServerHasActionNr(numberOfActions + 1))
    numberOfActions++
}

fixactionsthread
int numberOfCleanActions = 0

loop{
    if numberOfActions > numberOfCleanActions {
        Action action = rawActions.get(numberOfActions)
        if(action.clock < cleanActions.get(numberOfCleanActions)){
            action.clock = cleanActions.get(numberOfCleanActions)
        }
        cleanActions.add(action)
        numberOfCleanActions++
    }
}



